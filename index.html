<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2">

  <title> 破耳狼 &middot; 破耳狼 </title>

  
  <link rel="stylesheet" href="http://moketao.gitcafe.io//css/poole.css">
  <link rel="stylesheet" href="http://moketao.gitcafe.io//css/syntax.css">
  <link rel="stylesheet" href="http://moketao.gitcafe.io//css/hyde.css">
  <link rel="stylesheet" href="http://fonts.useso.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="http://moketao.gitcafe.io/index.xml" rel="alternate" type="application/rss+xml" title="破耳狼" />
  
  
			<link rel="stylesheet" href="http://moketao.gitcafe.io//css/prettify.css">
			<script src="http://moketao.gitcafe.io//css/jquery.js"></script>
			<script src="http://moketao.gitcafe.io//css/prettify.js"></script>
			<script type="text/javascript">
        function lineDistance( point1, point2 )
        {
          var xs = 0;
          var ys = 0;
         
          xs = point2.x - point1.x;
          xs = xs * xs;
         
          ys = point2.y - point1.y;
          ys = ys * ys;
         
          return Math.sqrt( xs + ys );
        }
				$(function(){
				$("pre").addClass("prettyprint linenums");
					prettyPrint();
          $("pre").on("mousedown",function(e){
              var me = $(this);
              me.data("posx",e.pageX);
              me.data("posy",e.pageY);
          });
          $("pre").on("mouseup",function(e){
              var me = $(this);
              me.data("posx");
              var p1 = {x:me.data("posx"),y:me.data("posy")};
              var p2 = {x:e.pageX,y:e.pageY};
              if(lineDistance(p2,p1)<10){
                var has = me.data("hasclick");
                if(has){
                  me.width(me.width()/3.2);
                  me.data("hasclick",false);
                }else{
                  me.width(me.width()*3.2);
                  me.data("hasclick",true);
                }
              }
          });
				});

			</script>
</head>

<body>

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>破耳狼</h1>
      <p class="lead">
      美术与程序双工<br/>GitHub Url : <a href="http://github.com/moketao">GitHub.com/moketao</a>
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
    </ul>

    <p>&copy; 2015. All rights reserved. </p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/unity_path_ios_android/">
        Unity3D常用路径解读（表格版本）
      </a>
    </h1>

    <span class="post-date">2015-04-24</span>

    

<table>
<thead>
<tr>
<th>Unity目录</th>
<th>特性</th>
<th>iTunes备份（ios）</th>
</tr>
</thead>

<tbody>
<tr>
<td>Application.<strong>dataPath</strong></td>
<td><strong>只读</strong> ，打包时内容已固定，不能更改，可以读取“sceneName.unity3d”(待验证)</td>
<td>yes</td>
</tr>

<tr>
<td>Application.<strong>streamingAssetsPath</strong></td>
<td><strong>只读</strong> ，打包时内容已固定，不能更改，程序员在Unity项目的Assets文件夹下手动创建的&rdquo;StreamingAssets&rdquo;目录，可以存放xml、json、jpg、mp4等等文件，手机平台上只读，台式机可以读写。</td>
<td>yes</td>
</tr>

<tr>
<td>Application.<strong>persistentDataPath</strong></td>
<td><strong>可读可写</strong>，用户使用过程中产生的数据，比如分享截图、下载音乐等等。此目录暴露给用户，用户打开iTunes就看得见，当然此目录也可以存放app生成的文件或下载文件。此目录会被备份到iTunes并同步到其它苹果设备（如果用户有多台iPhone的话），但是app审核上线期间不要在这个目录占用太多，否则有可能会通不过审核，如果更新包很大的话，推荐使用Application.<strong>temporaryCachePath</strong> 存放下载更新包。</td>
<td>yes</td>
</tr>

<tr>
<td>Application.<strong>temporaryCachePath</strong></td>
<td><strong>可读可写</strong>，不会被iTunes备份，但也不会被删除，会一直保留在当前设备。</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>关于ios的目录权限，可进一步参考 <a href="https://developer.apple.com/library/ios/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html">这里</a> 和 <a href="https://developer.apple.com/icloud/documentation/data-storage/index.html">这里</a>。</p>

<p>streamingAssetsPath下的文件读取方法是：
<pre><code>#if UNITY_EDITOR
    string filepath = Application.dataPath +&ldquo;/StreamingAssets&rdquo;+&ldquo;/my.xml&rdquo;;
#elif UNITY_IPHONE
    string filepath = Application.dataPath +&ldquo;/Raw&rdquo;+&ldquo;/my.xml&rdquo;;
#elif UNITY_ANDROID
    string filepath = &ldquo;jar:file://&rdquo; + Application.dataPath + &ldquo;!/assets/&rdquo;+&ldquo;/my.xml;
</code></pre></p>

<h3 id="ios:16683e76e14a70877b630ac3dd20e29c">IOS:</h3>

<pre><code>Application.dataPath :             Application/xxxx-xxxx-xxxx-xxxxxxxxxxxx/xxx.app/Data
Application.streamingAssetsPath :  Application/xxxx-xxxx-xxxxxxxxxxxx/xxx.app/Data/Raw
Application.persistentDataPath :   Application/xxxx-xxxx-xxxxxxxxxxxx/Documents
Application.temporaryCachePath :   Application/xxxx-xxxx-xxxxxxxxxxxx/Library/Caches</code></pre>

<h3 id="android:16683e76e14a70877b630ac3dd20e29c">Android:</h3>

<pre><code>Application.dataPath :                /data/app/xxx.xxx.xxx.apk
Application.streamingAssetsPath :     jar:file:///data/app/xxx.xxx.xxx.apk/!/assets
Application.persistentDataPath :      /data/data/xxx.xxx.xxx/files
Application.temporaryCachePath :      /data/data/xxx.xxx.xxx/cache</code></pre>

<h3 id="windows:16683e76e14a70877b630ac3dd20e29c">Windows:</h3>

<pre><code>Application.dataPath :                /Assets
Application.streamingAssetsPath :     /Assets/StreamingAssets
Application.persistentDataPath :      C:/Users/xxxx/AppData/LocalLow/CompanyName/ProductName
Application.temporaryCachePath :      C:/Users/xxxx/AppData/Local/Temp/CompanyName/ProductName</code></pre>

<h3 id="mac:16683e76e14a70877b630ac3dd20e29c">Mac:</h3>

<pre><code>Application.dataPath :                /Assets
Application.streamingAssetsPath :     /Assets/StreamingAssets
Application.persistentDataPath :      /Users/xxxx/Library/Caches/CompanyName/Product Name
Application.temporaryCachePath :      /var/folders/57/6b4_9w8113x2fsmzx_yhrhvh0000gn/T/CompanyName/Product Name</code></pre>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/unity_shader_gpu_hair/">
        使用 Unity Shader 实现 GPU Hair
      </a>
    </h1>

    <span class="post-date">2015-04-94</span>

    <p>本来想用 <strong>Unity</strong> <strong>布料系统</strong> 实现头发或飘带等效果，但是使用过后，发现非常消耗性能。
所以不得不研究别的办法。
下面是我的实现方法，<strong>GPU Hair</strong>：
<img src="/img/gpuhair.png" alt="" />
</p>

<pre>
Shader "Custom/GPUHair"{
    Properties{
        _MainTex ("Base (RGB)", 2D) = "white" {}        //贴图
        _DelayPoint ("DelayPoint", Vector) = (9.0,0,0,0)//尾部位置
        _HairLength("HairLength",Float) = 5             //头发长度
        _TimeScale("TimeScale",Range(0.0,200)) = 50     //波形速度
    }
    SubShader{
        Tags{"RenderType"="Opaque"}
        Cull off
        CGPROGRAM
        #pragma surface SurfFun Lambert vertex:VertFun
        sampler2D _MainTex;

        float _TimeScale;
        float4 _DelayPoint;
        float _HairLength;

        void VertFun(inout appdata_full v){
            _DelayPoint.w = 1;//修正头发变形的bug
            float4 localPos = mul(_World2Object,_DelayPoint);//把尾部的坐标，从世界坐标系挪移进头发模型中
            float factor = clamp(v.vertex.x/_HairLength,0,1);//当前点在发根到发梢的哪个位置（0~1.0）
            float tmpZ = v.vertex.z;//记录z
            v.vertex.z = 0;//把当前点先暂时挪到中间
            float4 dis = pow(factor,2)*(localPos - v.vertex);//当前点到尾部的距离
            v.vertex.y += factor*2*cos(v.vertex.x - _Time*_TimeScale);//波形
            v.vertex = v.vertex + dis;//波形加上甩尾偏移（当人物或者发根移动的时候）
            v.vertex.z += tmpZ;//恢复之前记录的z
        }

        struct Input{
            float2 uv_MainTex;
        };
        void SurfFun(Input IN, inout SurfaceOutput o){
            half4 c = tex2D (_MainTex, IN.uv_MainTex);
            o.Albedo = c.rgb;
            o.Alpha = c.a;
        }
        ENDCG
    }
    Fallback "Diffuse"
}
</pre>

<p>另外，场景里对应的网格物体，需要再挂一个脚本：</p>

<pre>
using UnityEngine;
using System.Collections;

public class DelayPoint : MonoBehaviour {

    public GameObject delayPoint;//尾部
    public float delayTime = 0.5f;

    private Transform t1;//网格物体中心点所在位置（发根）
    private Transform t2;//尾部所在位置（发梢）
    private Vector3 distanceToT1;//尾部到中心的距离

    private Vector3 velocity = Vector3.zero;//当前速度
    private Vector3 targetPoint = Vector3.zero;//跟随点

    void Start () {
        t1 = transform;
        t2 = delayPoint.transform;
        distanceToT1 = t2.position - t1.position;
    }
    
    void Update () {
        targetPoint = t1.position + distanceToT1;
        Vector3 newPos = Vector3.SmoothDamp(t2.position, targetPoint, ref velocity, delayTime);//尾部的缓动效果
        t2.position = newPos;
        Renderer render = t1.GetComponent<Renderer>();
        render.material.SetVector("_DelayPoint", t2.position);//将尾部的坐标传送给显卡
    }
}
</pre>

<p>具体使用方法：</p>

<ol>
<li>建立一个plane，大小默认（边长是10），或者用3dsmax建模。</li>
<li>给plane加上脚本和材质，材质的Shader指定为 Custom/GPUHair。</li>
<li>建立一个空物体，放置到plane边缘，大概是（5,0,0）的位置。</li>
<li>在脚本上你会看见一个delayPoint的属性，把空物体拖拽到这个属性上。</li>
<li>点击播放按钮。</li>
</ol>

<p>将来可能会支持碰撞检测，大致的思路已经有了，支持一个碰撞圆应该没问题。</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/sublime_autocomplete/">
        用sublime写shader也可以有 autocomplete（笨办法）
      </a>
    </h1>

    <span class="post-date">2015-04-84</span>

    <p>编写 Unity 的Shader，最痛苦的就是没有代码 <strong>自动完成</strong> 的代码提示了，今天装了 <strong>Sublime Text</strong>，只有高亮，于是想出一种超龊的办法，在前面粘贴一段类似的注释代码，如图：</p>

<p><img src="/img/subl_auto.png" alt="sublime_unity_shader_auto_complete" />
</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/dxsdk_install_err/">
        dxsdk 安装过程中报错: S1023
      </a>
    </h1>

    <span class="post-date">2015-04-54</span>

    

<p>安装directx sdk 报错： errors were encountered during installation of redistributable package s1023</p>

<h3 id="解决步奏:31e555ba754a60275651e451df32011c">解决步奏:</h3>

<ol>
<li>点击系统的【开始】按钮，然后点【运行】</li>
<li>输入<strong>cmd</strong>，回车</li>
<li>分别粘贴如下命令，回车（目的是卸载某些冲突的组件）
<pre><code>MsiExec.exe /passive /X{F0C3E5D1-1ADE-321E-8167-68EF0DE699A5}
MsiExec.exe /passive /X{1D8E6291-B0D5-35EC-8441-6616F567A0F7}
</code></pre></li>
<li>重新安装 dx sdk</li>
<li>再安装刚才卸载的 <a href="http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&amp;id=26999">组件</a> 如果是64位系统，最好 <strong>vcredist_x86.exe</strong> 和 <strong>vcredist_x64.exe</strong> 都装一次。</li>
</ol>

<p>英文解决方案原帖，点 <a href="http://blogs.msdn.com/b/chuckw/archive/2011/12/09/known-issue-directx-sdk-june-2010-setup-and-the-s1023-error.aspx">这里</a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/unityvs_install/">
        UnityVS 安装与使用
      </a>
    </h1>

    <span class="post-date">2015-04-54</span>

    <ol>
<li>先安装 <strong>VS2013</strong>。</li>
<li>然后再安装 <strong>UnityVS</strong> ，UnityVS在2014年被微软收购，所以现在是免费的，感谢微软。VS2013对应UnityVS 2013，从<a href="https://visualstudiogallery.msdn.microsoft.com/20b80b8c-659b-45ef-96c1-437828fe7cf2">这里</a>下载，下载页面可以选择其他版本的UnityVS，比如2015版本的。</li>
<li>进入Unity，导入UnityVS包。</li>
<li>检查看一下Unity的菜单：Edit &gt;&gt; Preferences &gt;&gt; External Script Editor 。 当前选项应该变成了 UnityVS.OpenFile，如果没有就手动选择一下。</li>
<li>这个时候再去新建 C# ，双击即可打开VS2013.</li>
</ol>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/3dgirl/">
        最近做的妹子
      </a>
    </h1>

    <span class="post-date">2015-04-114</span>

    <p><img src="/img/idle08.jpg" alt="" />
</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/Golang_cuda_Windows/">
        Golang、cuda、Windows 开发环境搭建
      </a>
    </h1>

    <span class="post-date">2015-04-104</span>

    

<h2 id="步骤:cb248cbf25583db7cd96fd4710d513a3">步骤</h2>

<ol>
<li>因为我的系统是 Win7 64位的，所以先装<strong>Mingw-w64</strong>，下载地址：<a href="http://sourceforge.net/projects/mingw-w64/">http://sourceforge.net/projects/mingw-w64/</a>
安装的时候选 x86_64，其它默认</li>
<li>然后安装<strong>CUDA</strong></li>
<li>然后安装<strong>Golang</strong></li>
<li>然后安装<strong>EveryThing</strong>，这是个文件搜索软件，等下会用到</li>
<li>打开命令窗口cmd，运行：<code>go get github.com/barnex/cuda5</code>，报错：<code>cannot find -lcuda</code>，网上搜出全都是Linux解决方案，让我抓狂，所以才有此文。</li>
<li>用EveryThing搜<strong>cgoflags.go</strong>，发现在GOPAT的某些目录下包含总共4个cgoflags.go文件，打开后，发现最后面有Windows相关配置</li>
<li>4个cgoflags.go文件依次打开，将内部有关Windows的部分，全部改成：</li>
</ol>

<blockquote>
<pre>
////WINDOWS:
//#cgo windows LDFLAGS:-LF:/cuda/bin/lib/x64
//#cgo windows CFLAGS: -IF:/cuda/bin/include
import "C"
</pre>
</blockquote>

<h2 id="注意事项:cb248cbf25583db7cd96fd4710d513a3">注意事项</h2>

<p>上面代码中的F:/cuda/bin/lib/x64，代表cuda安装目录下的的lib目录，</p>

<p>上面代码中的F:/cuda/bin/include，代表cuda安装目录下的的include目录。</p>

<p>如果你的cuda安装在<strong>C盘</strong>，则上面相应位置则是以C:/开头，而不是F:/开头。</p>

<p>斜杠注释不要去掉，golang能读，import &ldquo;C&rdquo;那一行必须与上一行<strong>紧贴</strong>，中间不能有空行。</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://moketao.gitcafe.io/about/">
        关于我
      </a>
    </h1>

    <span class="post-date">2015-04-14</span>

    

<h2 id="联系方式:6083a88ee3411b0d17ce02d738f69d47">联系方式</h2>

<ul>
<li>name 莫克陶</li>
<li>email moketao@qq.com</li>
<li>qq 30558209</li>
</ul>

<h2 id="经历:6083a88ee3411b0d17ce02d738f69d47">经历</h2>

<ul>
<li>2011 web.4399.com</li>
<li>2013 www.zqgame.com.cn</li>
</ul>

  </div>
  
</div>
</div>

  </body>
</html>
